#define N 16


static int aa[N]={ 0, 1, 2,3, 4, 5, 6,7, 8,9,10,11,12,13,14,15},
	    p[N]={11,13,12,6,17,15,14,8,10,9,11, 0, 5, 3, 2, 4};

/* í∏ì_êîÇRÇQÇÃÉOÉâÉt */
static int g32[32][32]={
{0,2,2,2,2,2,1,3,2,0,2,2,2,2,1,1,2,2,0,2,2,2,1,1,2,2,2,0,2,2,1,3},
{2,0,2,2,0,2,1,3,2,2,2,2,2,0,1,3,1,1,1,1,1,1,0,2,3,1,1,3,3,3,2,0},
{0,2,0,2,2,4,2,2,2,0,2,2,4,2,2,2,2,2,0,4,2,2,4,4,2,2,4,0,2,2,2,2},
{2,4,2,0,0,2,4,4,4,2,2,2,2,0,4,4,2,2,4,2,4,4,0,2,2,2,4,2,4,4,2,0},
{0,2,2,2,0,1,3,2,2,0,2,2,2,3,1,2,2,2,0,2,2,3,3,4,2,2,2,0,2,3,3,4},
{2,2,2,2,0,0,1,2,1,3,3,3,1,0,2,1,3,1,3,3,1,2,0,1,2,2,4,4,2,1,1,0},
{0,6,5,5,4,5,0,1,6,0,1,1,2,1,4,5,5,1,0,2,1,2,5,4,5,1,2,0,1,2,3,4},
{4,2,1,1,0,3,4,0,5,1,2,2,3,0,5,4,2,4,5,3,4,5,0,3,1,5,4,4,3,4,3,0},
{0,2,2,2,2,2,1,3,0,0,2,2,2,2,1,1,2,2,0,2,2,2,1,1,2,2,2,0,2,2,1,3},
{2,2,2,2,0,2,1,3,2,0,2,2,2,0,1,3,1,1,1,1,1,1,0,2,3,1,1,3,3,3,2,0},
{0,2,2,2,2,4,2,2,2,0,0,2,4,2,2,2,2,2,0,4,2,2,4,4,2,2,4,0,2,2,2,2},
{2,4,2,2,0,2,4,4,4,2,2,0,2,0,4,4,2,2,4,2,4,4,0,2,2,2,4,2,4,4,2,0},
{0,2,2,2,2,1,3,2,2,0,2,2,0,3,1,2,2,2,0,2,2,3,3,4,2,2,2,0,2,3,3,4},
{2,2,2,2,0,1,1,2,1,3,3,3,1,0,2,1,3,1,3,3,1,2,0,1,2,2,4,4,2,1,1,0},
{0,6,5,5,4,5,2,1,6,0,1,1,2,1,0,5,5,1,0,2,1,2,5,4,5,1,2,0,1,2,3,4},
{4,2,1,1,0,3,4,3,5,1,2,2,3,0,5,0,2,4,5,3,4,5,0,3,1,5,4,4,3,4,3,0},
{0,2,2,2,2,2,1,3,2,0,2,2,2,2,1,1,0,2,0,2,2,2,1,1,2,2,2,0,2,2,1,3},
{2,2,2,2,0,2,1,3,2,2,2,2,2,0,1,3,1,0,1,1,1,1,0,2,3,1,1,3,3,3,2,0},
{0,2,2,2,2,4,2,2,2,0,2,2,4,2,2,2,2,2,0,4,2,2,4,4,2,2,4,0,2,2,2,2},
{2,4,2,2,0,2,4,4,4,2,2,2,2,0,4,4,2,2,4,0,4,4,0,2,2,2,4,2,4,4,2,0},
{0,2,2,2,2,1,3,2,2,0,2,2,2,3,1,2,2,2,0,2,0,3,3,4,2,2,2,0,2,3,3,4},
{2,2,2,2,0,1,1,2,1,3,3,3,1,0,2,1,3,1,3,3,1,0,0,1,2,2,4,4,2,1,1,0},
{0,6,5,5,4,5,2,1,6,0,1,1,2,1,4,5,5,1,0,2,1,2,0,4,5,1,2,0,1,2,3,4},
{4,2,1,1,0,3,4,3,5,1,2,2,3,0,5,4,2,4,5,3,4,5,0,0,1,5,4,4,3,4,3,0},
{0,2,2,2,2,2,1,3,2,0,2,2,2,2,1,1,2,2,0,2,2,2,1,1,0,2,2,0,2,2,1,3},
{2,2,2,2,0,2,1,3,2,2,2,2,2,0,1,3,1,1,1,1,1,1,0,2,3,0,1,3,3,3,2,0},
{0,2,2,2,2,4,2,2,2,0,2,2,4,2,2,2,2,2,0,4,2,2,4,4,2,2,0,0,2,2,2,2},
{2,4,2,2,0,2,4,4,4,2,2,2,2,0,4,4,2,2,4,2,4,4,0,2,2,2,4,0,4,4,2,0},
{0,2,2,2,2,1,3,2,2,0,2,2,2,3,1,2,2,2,0,2,2,3,3,4,2,2,2,0,0,3,3,4},
{2,2,2,2,0,1,1,2,1,3,3,3,1,0,2,1,3,1,3,3,1,2,0,1,2,2,4,4,2,0,1,0},
{0,6,5,5,4,5,2,1,6,0,1,1,2,1,4,5,5,1,0,2,1,2,5,4,5,1,2,0,1,2,0,4},
{4,2,1,1,0,3,4,3,5,1,2,2,3,0,5,4,2,4,5,3,4,5,0,3,1,5,4,4,3,4,3,0}
};


unsigned int kk[8];
int compare(char **,char **);
int *l;


main(){
	int i,j,n,c=0;
	int **tmp,**t,t2[N],t3[8];


n=0;
while(n<N)
printf("%d ",p[n++]);
printf("\n");

*tmp=q2(16,p);
*t=q2(16,aa);
/* printf("%d %d %d\n",tmp,*tmp,**tmp); */


for(i=0;i<N;i++)
printf("%d,",*(*tmp)++);
printf("\n");
for(i=0;i<N;i++)
printf("%d,",*(*t)++);
printf("\n");

for(i=0;i<N;i++){
(*tmp)++; (*t)++;
if(**tmp == **t)
{ c++; printf("%d %d\n",**tmp,**t); }
}
printf("%d\n",c);


}



void arrcmp(char **t1,char **t2)
{
int i,j,c=0;


for(i=0;i<N;i++){
if(*(*t1)++ == *(*t2)++)
{ c++; printf("%d %d\n",**t1,**t2); }
}

printf("%d\n",N-c);
}


static int compare(char **k1,char **k2)
{
	return (strcmp(*k1,*k2));
}


void qsrt(int *l,int *r)
{
int *p=l,*q=r,w,x,i,j;


x= *(l+(r-l>>1));
do{
while(*p<x)
p++;
while(*q>x)
q--;
if(p>q)
break;
w=*p;*p=*q;*q=w;
} while(++p<= --q);

if(l<q)
qsrt(l,q);
if(p<r)
qsrt(p,r);

if(q-p==4){
for(i=0;i<16;i++)
printf("%d ",*l++);
printf("\n");
}

}


int q2(int n,int a[])
{
int i,j,l,r,p;
int lstack[32],rstack[32];
int x,t;

l=0; r=n-1; p=0;
for(;;){
if(r-l<= 10){
if(p==0) break;
p--;
l=lstack[p];
r=rstack[p];
}
x=a[(l+r)/2];
i=l; j=r;
for(;;){
while(a[i]<x) i++;
while(x<a[j]) j--;
if(i>=j) break;
t=a[i]; a[i]=a[j]; a[j]=t;
i++; j--;
}
if(i-l>r-j){
if(i-l> 10){
lstack[p]=l;
rstack[p]=i-1;
p++;
}
l=j+1;
}else{
if(r-j>10){
lstack[p]=j+1;
rstack[p]=r;
p++;
}
r=i-1;
}
}


for(i=1;i<n;i++){
x=a[i];
for(j=i-1;j>=0 && a[j]>x;j--)
a[j+1]=a[j];
a[j+1]=x;
}

return a;

/*
for(i=0;i<n;i++)
printf("%d ",a[i]);
printf("\n");
*/
}



"00001111112222222222222222222233",
"00000111111111122222222222333333",
"00000222222222222222222222444444",
"00000222222222222222444444444444",
"00000112222222222222222233333344",
"00000111111111222222222233333344",
"00000111111112222234444555555566",
"00000111122223333334444444455555",
"00000111111222222222222222222233",
"00000111111111122222222222333333",
"00000222222222222222222222444444",
"00000222222222222222444444444444",
"00000112222222222222222233333344",
"00001111111111222222222233333344",
"00000111111112222223444555555566",
"00000111122223333333444444455555",
"00000111111222222222222222222233",
"00000111111111222222222222333333",
"00002222222222222222222222444444",
"00000222222222222222444444444444",
"00000112222222222222222233333344",
"00000111111111122222222233333344",
"00000111111112222223444455555566",
"00000111122223333334444444455555",
"00000111111222222222222222222233",
"00000111111111222222222222333333",
"00000222222222222222222222244444",
"00000222222222222222444444444444",
"00000112222222222222222233333344",
"00000111111111222222222233333344",
"00000111111112222224444555555566",
"00001111222233333334444444455555"
